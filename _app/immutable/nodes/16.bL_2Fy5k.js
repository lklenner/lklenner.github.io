import"../chunks/Bg9kRutz.js";import{I as ft,J as ht,L as Rt,M as Yt,i as Ft,u as Jt,b as Vt,p as G,m as s,c as l,r,t as H,a as K,n as zt,f as nt,s as v,aj as Gt,v as Kt,N as _t,o as Ut}from"../chunks/DCGbEjkp.js";import{t as A,a as x,c as Wt}from"../chunks/B6we1ui4.js";import{c as wt,i as Xt,y as Zt,d as $t,q as bt,T as J,Q as pt,P as te,a as ee}from"../chunks/Dtfp-KIX.js";import{R as ae}from"../chunks/EjqemIE5.js";import{a as D,o as yt,s as M}from"../chunks/Cc6sp6Aj.js";import{s as C}from"../chunks/DjLPlESz.js";import{p as Q,i as oe}from"../chunks/R7SZNG97.js";import{c as ne,s as ot,r as se}from"../chunks/CQJXRoj6.js";import{s as z}from"../chunks/DctH-kaB.js";import{d as Tt}from"../chunks/nxS3RBuk.js";import{t as m,N as re}from"../chunks/Cl8tRtSd.js";import{N as ie,a as gt}from"../chunks/BPM-ywpK.js";import{g as V}from"../chunks/CxHFiZ8Q.js";import{D as kt,_ as ce}from"../chunks/DVFnT5Qc.js";import{T as le}from"../chunks/BaBBfbhg.js";import{I as Bt,a as w}from"../chunks/BVxO1hEQ.js";import{p as j}from"../chunks/CZpImU8R.js";import{s as de}from"../chunks/mvie_evA.js";function me(n){var e=Rt,o=Yt;ft(null),ht(null);try{return n()}finally{ft(e),ht(o)}}function ue(n,e,o,i=o){n.addEventListener(e,()=>me(o));const d=n.__on_r;d?n.__on_r=()=>{d(),i(!0)}:n.__on_r=()=>i(!0),ne()}function ve(n,e,o=e){ue(n,"change",i=>{var d=i?n.defaultChecked:n.checked;o(d)}),(Ft&&n.defaultChecked!==n.checked||Jt(e)==null)&&o(n.checked),Vt(()=>{var i=e();n.checked=!!i})}class I{static Button(e,o,i){return{text:e,cssClass:o,onClick:i}}}var fe=A('<div class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><!></div></div></div>');function he(n,e){G(e,!0);let o=j(e,"id",7),i=j(e,"show",15);o(Bt.makeDefault());let d=D(null),_="static";i(function(){var b;(b=s(d))==null||b.show()}),yt(()=>{M(d,Q(new bootstrap.Modal(`#${o()}`,{}))),document.getElementById(`${o()}`).addEventListener("hidden.bs.modal",E=>{var p;(p=e.onClose)==null||p.call(e,s(d))})});var u=fe();ot(u,"data-bs-backdrop",_);var h=l(u),y=l(h),T=l(y);de(T,()=>e.content,()=>s(d)),r(y),r(h),r(u),H(()=>ot(u,"id",o())),x(n,u),K()}var _e=(n,e,o,i)=>s(e).onClick(o(),i()),be=A('<button type="button"> </button>'),pe=A('<div class="modal-header"><h5 class="modal-title"> </h5></div> <div class="modal-body"><p> </p></div> <div class="modal-footer"></div>',1);function at(n,e){G(e,!0);const o=(u,h=zt)=>{var y=pe(),T=nt(y),b=l(T),E=l(b,!0);r(b),r(T);var p=v(T,2),S=l(p),q=l(S,!0);r(S),r(p);var P=v(p,2);wt(P,21,i,Xt,(U,L)=>{var B=be();B.__click=[_e,L,h,d];var W=l(B,!0);r(B),H(()=>{z(B,1,`btn ${s(L).cssClass??""}`),C(W,s(L).text)}),x(U,B)}),r(P),H(()=>{C(E,e.title),C(q,e.body)}),x(u,y)};let i=j(e,"buttons",19,()=>[]),d=j(e,"state",19,()=>({})),_=j(e,"show",15);Bt.makeDefault(),he(n,{content:o,onClose:u=>e.onClose(u,d()),get show(){return _()},set show(u){_(u)}}),K()}Tt(["click"]);class ge{static new(e,o,i){return{id:e,name:o,color:i}}}var ke=(n,e,o)=>e(s(o)),we=A('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),ye=(n,e)=>{e("timesheet")},Te=A('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),Be=A(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!>  <!>  <!> <!> <!>`,1);function Ce(n,e){G(e,!0);let o=D(""),i=D(void 0),d=Zt.getDay(new Date),_=_t(()=>{let t=[],a=0;for(const c of $t.rune)c.hidden||(t.push(ge.new(a,c.name,c.color)),a++);return t});Gt(()=>{M(o,`${Math.floor(m.rune.duration/3600).toString().padStart(2,"0")}:${Math.floor(m.rune.duration/60%60).toString().padStart(2,"0")}:${(m.rune.duration%60).toString().padStart(2,"0")}`)});let u=null,h=null;const y=ie.Item("Home",()=>{q("home")});function T(t){var a;if(((a=m.rune.activeItem)==null?void 0:a.id)!==t.id){if(m.rune.activeItem)if(bt.rune.interaction.confirmAllTaskSwitches||m.rune.duration<5){u=t,s(X)();return}else S();b(t)}}async function b(t){m.activate(t),t.id===s(_).length-1&&(await Ut(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function E(){}function p(){S(),m.deactivate()}function S(){const t=J.getTimestamp(m.rune.startTime),a=new Date,c=J.getTimestamp(a);let g=pt.Office;w.rune.atHome&&(g=pt.Home);const f=J.new(m.rune.activeItem.name,t,c,g,!1);try{J.validate(f)}catch(k){s(i)("Task entry was not created!",k.message,"text-bg-danger");return}d.timesheet.push(f),kt.enableTracked(d),kt.modified(d),console.log(f),te.modified(),s(i)("Created task entry",m.rune.activeItem.name,"text-bg-success")}function q(t){switch(h=t,h){case"back":gt.goBack();break;case"timesheet":V(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:V("/app");break}}const P="Confirm Item Switch",U=_t(()=>bt.rune.interaction.confirmAllTaskSwitches?"Are you sure you want to switch to another item?":"The current item has been active for less than a minute. Are you sure you want to switch to another item?"),L=I.Button("Yes, switch","btn-primary",function(a,c){S(),b(u),u=null,a.hide()}),B=I.Button("Cancel","btn-secondary",function(a,c){u=null,a.hide()}),W=[L,B];let X=D(void 0);const Ct="Confirm Leave",xt="Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.",St=I.Button("Yes, leave","btn-primary",function(a,c){a.hide()}),It=I.Button("Cancel","btn-secondary",function(a,c){h=null,a.hide()}),Dt=[St,It];let st=D(void 0);function Mt(t,a){if(h)switch(m.isActive()&&p(),h){case"back":gt.goBack();break;case"timesheet":V(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:V("/app");break}}const Ht="Set Quota Type",At="Are you working from your home or the office?",Et=I.Button("Home","btn-primary",function(a,c){c.location="home",w.rune.atHome=!0,a.hide()}),Lt=I.Button("Office","btn-secondary",function(a,c){c.location="office",w.rune.atHome=!1,a.hide()}),Nt=[Et,Lt];let Z=D(void 0);yt(()=>{w.rune.hasTracked||(s(Z)(),w.rune.hasTracked=!0)});var rt=Be(),it=nt(rt);re(it,{name:"Track",navItems:[y]});var R=v(it,2),$=v(l(R),2),ct=l($);se(ct),Kt(2),r($);var tt=v($,2);wt(tt,21,()=>s(_),t=>t.name,(t,a)=>{var c=we();let g;c.__click=[ke,T,a];var f=l(c),k=l(f),Y=l(k),N=l(Y,!0);r(Y),r(k),r(f),r(c),H(et=>{var O,F;g=z(c,1,"col-12 mb-2 svelte-19s4utb",null,g,{active:((O=m.rune.activeItem)==null?void 0:O.name)===s(a).name}),z(f,1,`card p-3 ${(((F=m.rune.activeItem)==null?void 0:F.name)===s(a).name?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),ot(f,"style",`color: ${et??""}; background-color: ${s(a).color??""};`),C(N,s(a).name)},[()=>ce(s(a).color)]),x(t,c)}),r(tt);var Ot=v(tt,2);Ot.__click=[ye,q],r(R);var lt=v(R,2);{var Qt=t=>{var a=Te(),c=l(a),g=l(c),f=v(l(g),2),k=l(f),Y=l(k,!0);r(k);var N=v(k,4),et=l(N,!0);r(N);var O=v(N,4),F=l(O,!0);r(O),r(f),r(g),r(c);var vt=v(c,2),qt=l(vt);qt.__click=p,r(vt),r(a),H(Pt=>{C(Y,m.rune.activeItem.name),C(et,Pt),C(F,s(o))},[()=>m.rune.startTime.toLocaleTimeString("de-DE")]),x(t,a)};oe(lt,t=>{m.isActive()&&t(Qt)})}var dt=v(lt,2);at(dt,{title:P,get body(){return s(U)},onClose:E,buttons:W,get show(){return s(X)},set show(t){M(X,Q(t))}});var mt=v(dt,2);at(mt,{title:Ct,body:xt,onClose:Mt,buttons:Dt,get show(){return s(st)},set show(t){M(st,Q(t))}});var ut=v(mt,2);at(ut,{title:Ht,body:At,onClose:E,buttons:Nt,get show(){return s(Z)},set show(t){M(Z,Q(t))}});var jt=v(ut,2);le(jt,{get show(){return s(i)},set show(t){M(i,Q(t))}}),H(t=>z(R,1,`container mt-3 mb-3 ${t??""}`,"svelte-19s4utb"),[()=>m.isActive()?"navbar-aware":""]),ve(ct,()=>w.rune.atHome,t=>w.rune.atHome=t),x(n,rt),K()}Tt(["click"]);function Ve(n,e){G(e,!0);var o=Wt(),i=nt(o);ee(i,()=>w.isLoaded(),null,(d,_)=>{Ce(d,{})},(d,_)=>{ae(d,{})}),x(n,o),K()}export{Ve as component};
