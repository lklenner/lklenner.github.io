import"../chunks/Bg9kRutz.js";import{Z as ut,_ as mt,$ as qt,z as Pt,h as Qt,ah as Rt,aI as Yt,p as G,c as o,s as c,r as e,a as J,aF as _t,g as a,f as wt,n as jt,ag as zt,t as F,b as Ft}from"../chunks/DxIxdwJJ.js";import{t as k,a as p,c as Vt}from"../chunks/ZBGWEsqd.js";import{d as yt,P as St,y as Zt,s as bt,t as Gt,Q as ft,a as Jt,R as Kt}from"../chunks/CIDEEFTv.js";import{a as I,s as f,o as Ut}from"../chunks/asY5pKAJ.js";import{s as L}from"../chunks/CBNDWGhJ.js";import{i as Z}from"../chunks/CNQ8E8sm.js";import{e as Wt}from"../chunks/lG1nzOo9.js";import{b as Xt,r as ta,a as aa}from"../chunks/CcgQRso9.js";import{s as V}from"../chunks/Dqg-VxYc.js";import{d as Tt}from"../chunks/CHGbQ8eI.js";import{p as A}from"../chunks/DX5c2CDw.js";import{a as $,S as ea}from"../chunks/3wMF4q86.js";import{N as pt}from"../chunks/Cr0fZnqe.js";import{g as N}from"../chunks/DcGapuE8.js";import{T as ht}from"../chunks/Cfk0PfAc.js";import{_ as oa}from"../chunks/sf-uOHMi.js";import{T as sa}from"../chunks/BsjGohmN.js";function na(s){var r=qt,l=Pt;ut(null),mt(null);try{return s()}finally{ut(r),mt(l)}}function ra(s,r,l,n=l){s.addEventListener(r,()=>na(l));const d=s.__on_r;d?s.__on_r=()=>{d(),n(!0)}:s.__on_r=()=>n(!0),Xt()}function ia(s,r,l=r){ra(s,"change",n=>{var d=n?s.defaultChecked:s.checked;l(d)}),(Qt&&s.defaultChecked!==s.checked||Rt(r)==null)&&l(s.checked),Yt(()=>{var n=r();s.checked=!!n})}function gt(s){return yt(s).getHours()}function kt(s){return yt(s).getMinutes()}var la=(s,r)=>{r.navigate("home")},ca=(s,r)=>{r.navigate("back")},da=k('<button class="btn btn-outline-success">Saved</button>'),va=()=>{St.save()},ua=k('<button class="btn btn-outline-warning">Modified</button>'),ma=k('<nav class="navbar navbar-expand bg-body-tertiary"><div class="container-fluid"><span class="navbar-brand">Track</span> <div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-lg-0"><li class="nav-item"><button class="nav-link">Home</button></li> <li class="nav-item"><button class="nav-link">Back</button></li></ul></div> <!></div></nav>');function _a(s,r){G(r,!0);var l=ma(),n=o(l),d=c(o(n),2),u=o(d),b=o(u),E=o(b);E.__click=[la,r],e(b);var w=c(b,2),y=o(w);y.__click=[ca,r],e(w),e(u),e(d);var O=c(d,2);{var S=m=>{var x=da();p(m,x)},T=m=>{var x=ua();x.__click=[va],p(m,x)};Z(O,m=>{$.rune.modified==ea.Saved?m(S):m(T,!1)})}e(n),e(l),p(s,l),J()}Tt(["click"]);var ba=(s,r,l)=>r(a(l)),fa=k('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),pa=(s,r)=>{r("timesheet")},ha=k('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),ga=k("<p>Are you sure you want to switch to another item?</p>"),ka=k("<p>The current item has been active for less than a minute. Are you sure you want to switch to another item?</p>"),wa=k(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!> <div id="modal-switch" class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Item Switch</h5></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Yes, Switch</button></div></div></div></div> <div id="modal-leave" class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Item Switch</h5></div> <div class="modal-body"><p>Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Yes, Leave</button></div></div></div></div> <!>`,1);function ya(s,r){G(r,!0);let l=zt(()=>{let t=[],i=0;for(const v of Gt.rune)v.hidden||(t.push({id:i,name:v.name,color:v.color}),i++);return t}),n=I(null),d=I(null),u=I(0),b=null,E=I("");_t(()=>{console.log(a(n))});let w=null,y=null,O=Zt.getDay(new Date),S,T,m=I(void 0);function x(t){var i;if(((i=a(n))==null?void 0:i.id)!==t.id){if(a(n))if(bt.rune.confirmAllTaskSwitches||a(u)<5){w=t,S.show();return}else q();K(t)}}async function K(t){f(n,A(t)),f(d,A(new Date)),f(u,0),b&&clearInterval(b),b=setInterval(()=>{f(u,A(Math.floor((new Date-a(d))/1e3)))},1e3),t.id===a(l).length-1&&(await Ft(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function xt(){S.hide(),q(),K(w),w=null}function Mt(){S.hide(),w=null}function U(){q(),f(n,null),f(d,null),f(u,0),clearInterval(b),b=null}function q(){const t=`${gt(a(d))}:${kt(a(d))}`,i=new Date,v=`${gt(i)}:${kt(i)}`;let h=ft.Office;$.rune.atHome&&(h=ft.Home),a(n).name;const _=ht.new(a(n).name,t,v,h,!1);try{ht.validate(_)}catch(g){a(m)("Task entry was not created!",g.message,"text-bg-danger");return}O.timesheet.push(_),console.log(_),St.modified(),a(m)("Created task entry",a(n).name,"text-bg-success")}function W(t){if(y=t,a(n))T.show();else switch(y){case"back":pt.goBack();break;case"timesheet":N(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:N("/app");break}}function Dt(){T.hide()}_t(()=>{f(E,`${Math.floor(a(u)/3600).toString().padStart(2,"0")}:${Math.floor(a(u)/60%60).toString().padStart(2,"0")}:${(a(u)%60).toString().padStart(2,"0")}`)}),Ut(()=>{S=new bootstrap.Modal("#modal-switch",{}),T=new bootstrap.Modal("#modal-leave",{}),document.getElementById("modal-leave").addEventListener("hidden.bs.modal",v=>{if(y)switch(a(n)&&U(),y){case"back":pt.goBack();break;case"timesheet":N(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:N("/app");break}}),[...document.querySelectorAll(".toast")].map(v=>new bootstrap.Toast(v,{animation:!0,autohide:!0,delay:2e3}))});var X=wa(),tt=wt(X);_a(tt,{navigate:W});var C=c(tt,2),P=c(o(C),2),at=o(P);ta(at),jt(2),e(P);var Q=c(P,2);Wt(Q,21,()=>a(l),t=>t.id,(t,i)=>{var v=fa();let h;v.__click=[ba,x,i];var _=o(v),g=o(_),B=o(g),M=o(B,!0);e(B),e(g),e(_),e(v),F(z=>{var D,H;h=V(v,1,"col-12 mb-2 svelte-19s4utb",null,h,{active:((D=a(n))==null?void 0:D.id)===a(i).id}),V(_,1,`card p-3 ${(((H=a(n))==null?void 0:H.id)===a(i).id?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),aa(_,"style",`color: ${z??""}; background-color: ${a(i).color??""};`),L(M,a(i).name)},[()=>oa(a(i).color)]),p(t,v)}),e(Q);var It=c(Q,2);It.__click=[pa,W],e(C);var et=c(C,2);{var $t=t=>{var i=ha(),v=o(i),h=o(v),_=c(o(h),2),g=o(_),B=o(g,!0);e(g);var M=c(g,4),z=o(M,!0);e(M);var D=c(M,4),H=o(D,!0);e(D),e(_),e(h),e(v);var vt=c(v,2),Nt=o(vt);Nt.__click=U,e(vt),e(i),F(Ot=>{L(B,a(n).name),L(z,Ot),L(H,a(E))},[()=>a(d).toLocaleTimeString()]),p(t,i)};Z(et,t=>{a(n)&&t($t)})}var R=c(et,2),ot=o(R),st=o(ot),Y=c(o(st),2),Et=o(Y);{var Ct=t=>{var i=ga();p(t,i)},Bt=t=>{var i=ka();p(t,i)};Z(Et,t=>{bt.rune.confirmAllTaskSwitches?t(Ct):t(Bt,!1)})}e(Y);var nt=c(Y,2),rt=o(nt);rt.__click=Mt;var Ht=c(rt,2);Ht.__click=xt,e(nt),e(st),e(ot),e(R);var j=c(R,2),it=o(j),lt=o(it),ct=c(o(lt),4),dt=o(ct);dt.__click=()=>{y=null,T.hide()};var Lt=c(dt,2);Lt.__click=Dt,e(ct),e(lt),e(it),e(j);var At=c(j,2);sa(At,{get show(){return a(m)},set show(t){f(m,A(t))}}),F(()=>V(C,1,`container mt-3 mb-3 ${(a(n)?"navbar-aware":"")??""}`,"svelte-19s4utb")),ia(at,()=>$.rune.atHome,t=>$.rune.atHome=t),p(s,X),J()}Tt(["click"]);function Ra(s,r){G(r,!0);var l=Vt(),n=wt(l);Jt(n,()=>$.isLoaded(),null,(d,u)=>{ya(d,{})},(d,u)=>{Kt(d,{})}),p(s,l),J()}export{Ra as component};
