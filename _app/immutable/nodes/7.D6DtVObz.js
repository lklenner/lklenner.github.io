import"../chunks/Bg9kRutz.js";import{Z as ct,_ as dt,$ as qt,z as Pt,h as Qt,ah as Rt,aI as Yt,p as F,c as o,s as c,r as e,a as Z,aF as jt,g as t,f as gt,n as zt,ag as Ft,t as vt}from"../chunks/DxIxdwJJ.js";import{t as w,a as h,c as Zt}from"../chunks/ZBGWEsqd.js";import{b as kt,P as wt,y as Gt,s as ut,t as Jt,Q as mt,a as Kt,R as Ut}from"../chunks/j4_4lskl.js";import{s as f,a as x,o as Vt}from"../chunks/asY5pKAJ.js";import{s as L}from"../chunks/CBNDWGhJ.js";import{i as z}from"../chunks/CNQ8E8sm.js";import{e as Wt,i as Xt}from"../chunks/lG1nzOo9.js";import{b as ta,r as aa,a as ea}from"../chunks/CcgQRso9.js";import{s as _t}from"../chunks/Dqg-VxYc.js";import{d as yt}from"../chunks/CHGbQ8eI.js";import{p as A}from"../chunks/DX5c2CDw.js";import{a as St,S as oa}from"../chunks/D9c1vjjh.js";import{N as ft}from"../chunks/h_wRifTa.js";import{g as H}from"../chunks/B-Oc13yR.js";import{T as bt}from"../chunks/BrEmoiAG.js";import{_ as sa}from"../chunks/BiBHf_xO.js";import{T as ra}from"../chunks/Burk0RPv.js";function na(s){var r=qt,l=Pt;ct(null),dt(null);try{return s()}finally{ct(r),dt(l)}}function ia(s,r,l,n=l){s.addEventListener(r,()=>na(l));const d=s.__on_r;d?s.__on_r=()=>{d(),n(!0)}:s.__on_r=()=>n(!0),ta()}function la(s,r,l=r){ia(s,"change",n=>{var d=n?s.defaultChecked:s.checked;l(d)}),(Qt&&s.defaultChecked!==s.checked||Rt(r)==null)&&l(s.checked),Yt(()=>{var n=r();s.checked=!!n})}function pt(s){return kt(s).getHours()}function ht(s){return kt(s).getMinutes()}var ca=(s,r)=>{r.navigate("home")},da=(s,r)=>{r.navigate("back")},va=w('<button class="btn btn-outline-success">Saved</button>'),ua=()=>{wt.save()},ma=w('<button class="btn btn-outline-warning">Modified</button>'),_a=w('<nav class="navbar navbar-expand bg-body-tertiary"><div class="container-fluid"><span class="navbar-brand">Track</span> <div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-lg-0"><li class="nav-item"><button class="nav-link">Home</button></li> <li class="nav-item"><button class="nav-link">Back</button></li></ul></div> <!></div></nav>');function fa(s,r){F(r,!0);var l=_a(),n=o(l),d=c(o(n),2),u=o(d),b=o(u),I=o(b);I.__click=[ca,r],e(b);var y=c(b,2),M=o(y);M.__click=[da,r],e(y),e(u),e(d);var S=c(d,2);{var B=m=>{var p=va();h(m,p)},T=m=>{var p=ma();p.__click=[ua],h(m,p)};z(S,m=>{St.rune.modified==oa.Saved?m(B):m(T,!1)})}e(n),e(l),h(s,l),Z()}yt(["click"]);var ba=(s,r,l)=>r(t(l)),pa=w('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),ha=(s,r)=>{r("timesheet")},ga=w('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),ka=w("<p>Are you sure you want to switch to another item?</p>"),wa=w("<p>The current item has been active for less than a minute. Are you sure you want to switch to another item?</p>"),ya=w(`<!> <div class="container mt-3 mb-3"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!> <div id="modal-switch" class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Item Switch</h5></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Yes, Switch</button></div></div></div></div> <div id="modal-leave" class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Item Switch</h5></div> <div class="modal-body"><p>Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Yes, Leave</button></div></div></div></div> <!>`,1);function Sa(s,r){F(r,!0);let l=Ft(()=>{let a=[],i=0;for(const v of Jt.rune)v.hidden||(a.push({id:i,name:v.name,color:v.color}),i++);return a}),n=x(null),d=x(null),u=x(0),b=null,I=x(""),y=null,M=x(!1),S=null,B=Gt.getDay(new Date),T,m,p=x(void 0);function Tt(a){var i;if(((i=t(n))==null?void 0:i.id)!==a.id){if(t(n))if(ut.rune.confirmAllTaskSwitches||t(u)<5){y=a,T.show();return}else N();G(a)}}function G(a){f(n,A(a)),f(d,A(new Date)),f(u,0),b&&clearInterval(b),b=setInterval(()=>{f(u,A(Math.floor((new Date-t(d))/1e3)))},1e3)}function xt(){T.hide(),N(),G(y),y=null}function Mt(){T.hide(),y=null}function J(){N(),f(n,null),f(d,null),f(u,0),clearInterval(b),b=null}function N(){const a=`${pt(t(d))}:${ht(t(d))}`,i=new Date,v=`${pt(i)}:${ht(i)}`;let g=mt.Office;t(M)&&(g=mt.Home),t(n).name;const _=bt.new(t(n).name,a,v,g,!1);try{bt.validate(_)}catch(k){t(p)("Task entry was not created!",k.message,"text-bg-danger");return}B.timesheet.push(_),console.log(_),wt.modified(),t(p)("Created task entry",t(n).name,"text-bg-success")}function K(a){if(S=a,t(n))m.show();else switch(S){case"back":ft.goBack();break;case"timesheet":H(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:H("/app");break}}function Dt(){m.hide()}jt(()=>{f(I,`${Math.floor(t(u)/3600).toString().padStart(2,"0")}:${Math.floor(t(u)/60).toString().padStart(2,"0")}:${(t(u)%60).toString().padStart(2,"0")}`)}),Vt(()=>{T=new bootstrap.Modal("#modal-switch",{}),m=new bootstrap.Modal("#modal-leave",{}),document.getElementById("modal-leave").addEventListener("hidden.bs.modal",v=>{if(S)switch(t(n)&&J(),S){case"back":ft.goBack();break;case"timesheet":H(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:H("/app");break}}),[...document.querySelectorAll(".toast")].map(v=>new bootstrap.Toast(v,{animation:!0,autohide:!0,delay:2e3}))});var U=ya(),V=gt(U);fa(V,{navigate:K});var O=c(V,2),q=c(o(O),2),W=o(q);aa(W),zt(2),e(q);var P=c(q,2);Wt(P,21,()=>t(l),Xt,(a,i)=>{var v=pa();let g;v.__click=[ba,Tt,i];var _=o(v),k=o(_),E=o(k),D=o(E,!0);e(E),e(k),e(_),e(v),vt(j=>{var $,C;g=_t(v,1,"col-12 mb-2 svelte-so7s27",null,g,{active:(($=t(n))==null?void 0:$.id)===t(i).id}),_t(_,1,`card p-3 ${(((C=t(n))==null?void 0:C.id)===t(i).id?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-so7s27"),ea(_,"style",`color: ${j??""}; background-color: ${t(i).color??""};`),L(D,t(i).name)},[()=>sa(t(i).color)]),h(a,v)}),e(P);var $t=c(P,2);$t.__click=[ha,K],e(O);var X=c(O,2);{var It=a=>{var i=ga(),v=o(i),g=o(v),_=c(o(g),2),k=o(_),E=o(k,!0);e(k);var D=c(k,4),j=o(D,!0);e(D);var $=c(D,4),C=o($,!0);e($),e(_),e(g),e(v);var lt=c(v,2),Nt=o(lt);Nt.__click=J,e(lt),e(i),vt(Ot=>{L(E,t(n).name),L(j,Ot),L(C,t(I))},[()=>t(d).toLocaleTimeString()]),h(a,i)};z(X,a=>{t(n)&&a(It)})}var Q=c(X,2),tt=o(Q),at=o(tt),R=c(o(at),2),Et=o(R);{var Ct=a=>{var i=ka();h(a,i)},Lt=a=>{var i=wa();h(a,i)};z(Et,a=>{ut.rune.confirmAllTaskSwitches?a(Ct):a(Lt,!1)})}e(R);var et=c(R,2),ot=o(et);ot.__click=Mt;var At=c(ot,2);At.__click=xt,e(et),e(at),e(tt),e(Q);var Y=c(Q,2),st=o(Y),rt=o(st),nt=c(o(rt),4),it=o(nt);it.__click=()=>{S=null,m.hide()};var Ht=c(it,2);Ht.__click=Dt,e(nt),e(rt),e(st),e(Y);var Bt=c(Y,2);ra(Bt,{get show(){return t(p)},set show(a){f(p,A(a))}}),la(W,()=>t(M),a=>f(M,a)),h(s,U),Z()}yt(["click"]);function Ya(s,r){F(r,!0);var l=Zt(),n=gt(l);Kt(n,()=>St.isLoaded(),null,(d,u)=>{Sa(d,{})},(d,u)=>{Ut(d,{})}),h(s,l),Z()}export{Ya as component};
