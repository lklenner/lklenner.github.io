import"../chunks/Bg9kRutz.js";import{h as Yt,a6 as qt,aA as Ft,p as J,k as t,c as i,r as s,t as A,a as K,n as Vt,f as nt,s as u,au as zt,j as Gt,A as vt,i as Jt}from"../chunks/B_fWjAJn.js";import{t as E,a as D,c as Kt}from"../chunks/CGZ7VXBK.js";import{c as pt,i as Ut,y as Wt,h as Xt,s as ft,T as V,Q as ht,P as Zt,g as $t,R as te}from"../chunks/D5QCgc3m.js";import{a as _,o as _t,s as v}from"../chunks/-5UQ7fw5.js";import{s as I}from"../chunks/DuGrHTQZ.js";import{p as Q,i as ee}from"../chunks/BKxV5vi2.js";import{s as ot,r as ae}from"../chunks/Ct4An_w0.js";import{s as G}from"../chunks/99q-nmkb.js";import{l as oe,d as gt}from"../chunks/dYPrhcUL.js";import{p as C}from"../chunks/BqFMnoIm.js";import{N as ne}from"../chunks/uvoJunv6.js";import{N as se,a as bt}from"../chunks/5xEhE_IQ.js";import{g as z}from"../chunks/BSzaa-A5.js";import{_ as re}from"../chunks/D1FUJGbv.js";import{T as ie}from"../chunks/DH4ajtYU.js";import{I as kt,a as x}from"../chunks/DsUiww_e.js";import{s as le}from"../chunks/Bqj9CX9d.js";import{T as ce}from"../chunks/CmRE5a5A.js";function de(c,n,a=n){oe(c,"change",d=>{var l=d?c.defaultChecked:c.checked;a(l)}),(Yt&&c.defaultChecked!==c.checked||qt(n)==null)&&a(c.checked),Ft(()=>{var d=n();c.checked=!!d})}class M{static Button(n,a,d){return{text:n,cssClass:a,onClick:d}}}var me=E('<div class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><!></div></div></div>');function ue(c,n){J(n,!0);let a=Q(n,"id",7),d=Q(n,"show",15);a(kt.makeDefault());let l=_(null),p="static";d(function(){var h;(h=t(l))==null||h.show()}),_t(()=>{v(l,C(new bootstrap.Modal(`#${a()}`,{}))),document.getElementById(`${a()}`).addEventListener("hidden.bs.modal",k=>{var w;(w=n.onClose)==null||w.call(n,t(l))})});var m=me();ot(m,"data-bs-backdrop",p);var H=i(m),g=i(H),f=i(g);le(f,()=>n.content,()=>t(l)),s(g),s(H),s(m),A(()=>ot(m,"id",a())),D(c,m),K()}var ve=(c,n,a,d)=>t(n).onClick(a(),d()),fe=E('<button type="button"> </button>'),he=E('<div class="modal-header"><h5 class="modal-title"> </h5></div> <div class="modal-body"><p> </p></div> <div class="modal-footer"></div>',1);function at(c,n){J(n,!0);const a=(m,H=Vt)=>{var g=he(),f=nt(g),h=i(f),k=i(h,!0);s(h),s(f);var w=u(f,2),j=i(w),P=i(j,!0);s(j),s(w);var N=u(w,2);pt(N,21,d,Ut,(R,S)=>{var y=fe();y.__click=[ve,S,H,l];var U=i(y,!0);s(y),A(()=>{G(y,1,`btn ${t(S).cssClass??""}`),I(U,t(S).text)}),D(R,y)}),s(N),A(()=>{I(k,n.title),I(P,n.body)}),D(m,g)};let d=Q(n,"buttons",19,()=>[]),l=Q(n,"state",19,()=>({})),p=Q(n,"show",15);kt.makeDefault(),ue(c,{content:a,onClose:m=>n.onClose(m,l()),get show(){return p()},set show(m){p(m)}}),K()}gt(["click"]);var be=(c,n,a)=>n(t(a)),pe=E('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),_e=(c,n)=>{n("timesheet")},ge=E('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),ke=E(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!>  <!>  <!> <!> <!>`,1);function we(c,n){J(n,!0);let a=_(null),d=_(null),l=_(0),p=_(""),m=_(void 0),H=Wt.getDay(new Date),g=vt(()=>{let e=[],o=0;for(const r of Xt.rune)r.hidden||(e.push({id:o,name:r.name,color:r.color}),o++);return e});zt(()=>{v(p,`${Math.floor(t(l)/3600).toString().padStart(2,"0")}:${Math.floor(t(l)/60%60).toString().padStart(2,"0")}:${(t(l)%60).toString().padStart(2,"0")}`)});let f=null,h=null,k=null;const w=se.Item("Home",()=>{y("home")});function j(e){var o;if(((o=t(a))==null?void 0:o.id)!==e.id){if(t(a))if(ft.rune.track.confirmAllTaskSwitches||t(l)<5){h=e,t(W)();return}else S();P(e)}}async function P(e){v(a,C(e)),v(d,C(new Date)),v(l,0),f&&clearInterval(f),f=setInterval(()=>{v(l,C(Math.floor((new Date-t(d))/1e3)))},1e3),e.id===t(g).length-1&&(await Jt(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function N(){}function R(){S(),v(a,null),v(d,null),v(l,0),clearInterval(f),f=null}function S(){const e=V.getTimestamp(t(d)),o=new Date,r=V.getTimestamp(o);let T=ht.Office;x.rune.atHome&&(T=ht.Home),t(a).name;const b=V.new(t(a).name,e,r,T,!1);try{V.validate(b)}catch(B){t(m)("Task entry was not created!",B.message,"text-bg-danger");return}H.timesheet.push(b),console.log(b),Zt.modified(),t(m)("Created task entry",t(a).name,"text-bg-success")}function y(e){if(k=e,t(a))t(X)();else switch(k){case"back":bt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const U="Confirm Item Switch",wt=vt(()=>ft.rune.track.confirmAllTaskSwitches?"Are you sure you want to switch to another item?":"The current item has been active for less than a minute. Are you sure you want to switch to another item?"),yt=M.Button("Yes, switch","btn-secondary",function(o,r){S(),P(h),h=null,o.hide()}),Tt=M.Button("Cancel","btn-secondary",function(o,r){h=null,o.hide()}),Bt=[yt,Tt];let W=_(void 0);const Ct="Confirm Item Switch",xt="Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.",St=M.Button("Yes, leave","btn-primary",function(o,r){o.hide()}),It=M.Button("Cancel","btn-secondary",function(o,r){k=null,o.hide()}),Dt=[St,It];let X=_(void 0);function Ht(e,o){if(k)switch(t(a)&&R(),k){case"back":bt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const Mt="Set Quota Type",At="Are you working from your home or the office?",Et=M.Button("Home","btn-secondary",function(o,r){r.location="home",x.rune.atHome=!0,o.hide()}),Nt=M.Button("Office","btn-secondary",function(o,r){r.location="office",x.rune.atHome=!1,o.hide()}),Ot=[Et,Nt];let Z=_(void 0);_t(()=>{ce.enable(),x.rune.hasTracked||(t(Z)(),x.rune.hasTracked=!0)});var st=ke(),rt=nt(st);ne(rt,{name:"Track",navItems:[w]});var Y=u(rt,2),$=u(i(Y),2),it=i($);ae(it),Gt(2),s($);var tt=u($,2);pt(tt,21,()=>t(g),e=>e.id,(e,o)=>{var r=pe();let T;r.__click=[be,j,o];var b=i(r),B=i(b),q=i(B),O=i(q,!0);s(q),s(B),s(b),s(r),A(et=>{var L,F;T=G(r,1,"col-12 mb-2 svelte-19s4utb",null,T,{active:((L=t(a))==null?void 0:L.id)===t(o).id}),G(b,1,`card p-3 ${(((F=t(a))==null?void 0:F.id)===t(o).id?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),ot(b,"style",`color: ${et??""}; background-color: ${t(o).color??""};`),I(O,t(o).name)},[()=>re(t(o).color)]),D(e,r)}),s(tt);var Lt=u(tt,2);Lt.__click=[_e,y],s(Y);var lt=u(Y,2);{var Qt=e=>{var o=ge(),r=i(o),T=i(r),b=u(i(T),2),B=i(b),q=i(B,!0);s(B);var O=u(B,4),et=i(O,!0);s(O);var L=u(O,4),F=i(L,!0);s(L),s(b),s(T),s(r);var ut=u(r,2),Pt=i(ut);Pt.__click=R,s(ut),s(o),A(Rt=>{I(q,t(a).name),I(et,Rt),I(F,t(p))},[()=>t(d).toLocaleTimeString("de-DE")]),D(e,o)};ee(lt,e=>{t(a)&&e(Qt)})}var ct=u(lt,2);at(ct,{title:U,get body(){return t(wt)},onClose:N,buttons:Bt,get show(){return t(W)},set show(e){v(W,C(e))}});var dt=u(ct,2);at(dt,{title:Ct,body:xt,onClose:Ht,buttons:Dt,get show(){return t(X)},set show(e){v(X,C(e))}});var mt=u(dt,2);at(mt,{title:Mt,body:At,onClose:N,buttons:Ot,get show(){return t(Z)},set show(e){v(Z,C(e))}});var jt=u(mt,2);ie(jt,{get show(){return t(m)},set show(e){v(m,C(e))}}),A(()=>G(Y,1,`container mt-3 mb-3 ${(t(a)?"navbar-aware":"")??""}`,"svelte-19s4utb")),de(it,()=>x.rune.atHome,e=>x.rune.atHome=e),D(c,st),K()}gt(["click"]);function Ye(c,n){J(n,!0);var a=Kt(),d=nt(a);$t(d,()=>x.isLoaded(),null,(l,p)=>{we(l,{})},(l,p)=>{te(l,{})}),D(c,a),K()}export{Ye as component};
