import"../chunks/Bg9kRutz.js";import{an as ft,ao as ht,a2 as Rt,O as Yt,l as zt,u as Ft,g as Vt,p as J,i as s,t as A,d as l,a0 as Gt,r,a as M,b as x,c as K,aO as Jt,f as nt,s as m,_ as Kt,k as Ut,z as _t,j as Wt,h as Xt}from"../chunks/DA61WD3S.js";import{c as wt,i as Zt,y as $t,d as te,q as bt,T as F,Q as pt,P as ee,a as ae}from"../chunks/E28ZXaGp.js";import{R as oe}from"../chunks/CAzcpioX.js";import{b as D,o as yt,a as H,d as Tt,s as C}from"../chunks/DwvvTgU3.js";import{p as Q,i as ne}from"../chunks/D8MQwctJ.js";import{c as se,s as ot,r as re}from"../chunks/ndif8Qsv.js";import{s as G}from"../chunks/BbVpoC1u.js";import{t as u,N as ie}from"../chunks/BWAQuPye.js";import{N as ce,a as gt}from"../chunks/BWQOId1f.js";import{g as V}from"../chunks/BUQyV99V.js";import{D as kt,_ as le}from"../chunks/Drbo5pG0.js";import{T as de}from"../chunks/CDDI765T.js";import{I as Bt,a as w}from"../chunks/DTXHbV85.js";import{p as j}from"../chunks/BxtgH2L7.js";import{T as ue}from"../chunks/CmRE5a5A.js";function ve(n){var e=Rt,o=Yt;ft(null),ht(null);try{return n()}finally{ft(e),ht(o)}}function me(n,e,o,i=o){n.addEventListener(e,()=>ve(o));const d=n.__on_r;d?n.__on_r=()=>{d(),i(!0)}:n.__on_r=()=>i(!0),se()}function fe(n,e,o=e){me(n,"change",i=>{var d=i?n.defaultChecked:n.checked;o(d)}),(zt&&n.defaultChecked!==n.checked||Ft(e)==null)&&o(n.checked),Vt(()=>{var i=e();n.checked=!!i})}class I{static Button(e,o,i){return{text:e,cssClass:o,onClick:i}}}var he=A('<div class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><!></div></div></div>');function _e(n,e){J(e,!0);let o=j(e,"id",7),i=j(e,"show",15);o(Bt.makeDefault());let d=D(null),_="static";i(function(){var b;(b=s(d))==null||b.show()}),yt(()=>{H(d,Q(new bootstrap.Modal(`#${o()}`,{}))),document.getElementById(`${o()}`).addEventListener("hidden.bs.modal",E=>{var p;(p=e.onClose)==null||p.call(e,s(d))})});var v=he();ot(v,"data-bs-backdrop",_);var h=l(v),y=l(h),T=l(y);Gt(T,()=>e.content,()=>s(d)),r(y),r(h),r(v),M(()=>ot(v,"id",o())),x(n,v),K()}var be=(n,e,o,i)=>s(e).onClick(o(),i()),pe=A('<button type="button"> </button>'),ge=A('<div class="modal-header"><h5 class="modal-title"> </h5></div> <div class="modal-body"><p> </p></div> <div class="modal-footer"></div>',1);function at(n,e){J(e,!0);const o=(v,h=Jt)=>{var y=ge(),T=nt(y),b=l(T),E=l(b,!0);r(b),r(T);var p=m(T,2),S=l(p),q=l(S,!0);r(S),r(p);var P=m(p,2);wt(P,21,i,Zt,(U,O)=>{var B=pe();B.__click=[be,O,h,d];var W=l(B,!0);r(B),M(()=>{G(B,1,`btn ${s(O).cssClass??""}`),C(W,s(O).text)}),x(U,B)}),r(P),M(()=>{C(E,e.title),C(q,e.body)}),x(v,y)};let i=j(e,"buttons",19,()=>[]),d=j(e,"state",19,()=>({})),_=j(e,"show",15);Bt.makeDefault(),_e(n,{content:o,onClose:v=>e.onClose(v,d()),get show(){return _()},set show(v){_(v)}}),K()}Tt(["click"]);class ke{static new(e,o,i){return{id:e,name:o,color:i}}}var we=(n,e,o)=>e(s(o)),ye=A('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),Te=(n,e)=>{e("timesheet")},Be=A('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),Ce=A(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!>  <!>  <!> <!> <!>`,1);function xe(n,e){J(e,!0);let o=D(""),i=D(void 0),d=$t.getDay(new Date),_=_t(()=>{let t=[],a=0;for(const c of te.rune)c.hidden||(t.push(ke.new(a,c.name,c.color)),a++);return t});Kt(()=>{H(o,`${Math.floor(u.rune.duration/3600).toString().padStart(2,"0")}:${Math.floor(u.rune.duration/60%60).toString().padStart(2,"0")}:${(u.rune.duration%60).toString().padStart(2,"0")}`)});let v=null,h=null;const y=ce.Item("Home",()=>{q("home")});function T(t){var a;if(((a=u.rune.activeItem)==null?void 0:a.id)!==t.id){if(u.rune.activeItem)if(bt.rune.interaction.confirmAllTaskSwitches||u.rune.duration<5){v=t,s(X)();return}else S();b(t)}}async function b(t){u.activate(t),t.id===s(_).length-1&&(await Wt(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function E(){}function p(){S(),u.deactivate()}function S(){const t=F.getTimestamp(u.rune.startTime),a=new Date,c=F.getTimestamp(a);let g=pt.Office;w.rune.atHome&&(g=pt.Home);const f=F.new(u.rune.activeItem.name,t,c,g,!1);try{F.validate(f)}catch(k){s(i)("Task entry was not created!",k.message,"text-bg-danger");return}d.timesheet.push(f),kt.enableTracked(d),kt.modified(d),console.log(f),ee.modified(),s(i)("Created task entry",u.rune.activeItem.name,"text-bg-success")}function q(t){switch(h=t,h){case"back":gt.goBack();break;case"timesheet":V(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:V("/app");break}}const P="Confirm Item Switch",U=_t(()=>bt.rune.interaction.confirmAllTaskSwitches?"Are you sure you want to switch to another item?":"The current item has been active for less than a minute. Are you sure you want to switch to another item?"),O=I.Button("Yes, switch","btn-primary",function(a,c){S(),b(v),v=null,a.hide()}),B=I.Button("Cancel","btn-secondary",function(a,c){v=null,a.hide()}),W=[O,B];let X=D(void 0);const Ct="Confirm Leave",xt="Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.",St=I.Button("Yes, leave","btn-primary",function(a,c){a.hide()}),It=I.Button("Cancel","btn-secondary",function(a,c){h=null,a.hide()}),Dt=[St,It];let st=D(void 0);function Ht(t,a){if(h)switch(u.isActive()&&p(),h){case"back":gt.goBack();break;case"timesheet":V(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:V("/app");break}}const Mt="Set Quota Type",At="Are you working from your home or the office?",Et=I.Button("Home","btn-primary",function(a,c){c.location="home",w.rune.atHome=!0,a.hide()}),Ot=I.Button("Office","btn-secondary",function(a,c){c.location="office",w.rune.atHome=!1,a.hide()}),Lt=[Et,Ot];let Z=D(void 0);yt(()=>{ue.enable(),w.rune.hasTracked||(s(Z)(),w.rune.hasTracked=!0)});var rt=Ce(),it=nt(rt);ie(it,{name:"Track",navItems:[y]});var R=m(it,2),$=m(l(R),2),ct=l($);re(ct),Ut(2),r($);var tt=m($,2);wt(tt,21,()=>s(_),t=>t.name,(t,a)=>{var c=ye();let g;c.__click=[we,T,a];var f=l(c),k=l(f),Y=l(k),L=l(Y,!0);r(Y),r(k),r(f),r(c),M(et=>{var N,z;g=G(c,1,"col-12 mb-2 svelte-19s4utb",null,g,{active:((N=u.rune.activeItem)==null?void 0:N.name)===s(a).name}),G(f,1,`card p-3 ${(((z=u.rune.activeItem)==null?void 0:z.name)===s(a).name?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),ot(f,"style",`color: ${et??""}; background-color: ${s(a).color??""};`),C(L,s(a).name)},[()=>le(s(a).color)]),x(t,c)}),r(tt);var Nt=m(tt,2);Nt.__click=[Te,q],r(R);var lt=m(R,2);{var Qt=t=>{var a=Be(),c=l(a),g=l(c),f=m(l(g),2),k=l(f),Y=l(k,!0);r(k);var L=m(k,4),et=l(L,!0);r(L);var N=m(L,4),z=l(N,!0);r(N),r(f),r(g),r(c);var mt=m(c,2),qt=l(mt);qt.__click=p,r(mt),r(a),M(Pt=>{C(Y,u.rune.activeItem.name),C(et,Pt),C(z,s(o))},[()=>u.rune.startTime.toLocaleTimeString("de-DE")]),x(t,a)};ne(lt,t=>{u.isActive()&&t(Qt)})}var dt=m(lt,2);at(dt,{title:P,get body(){return s(U)},onClose:E,buttons:W,get show(){return s(X)},set show(t){H(X,Q(t))}});var ut=m(dt,2);at(ut,{title:Ct,body:xt,onClose:Ht,buttons:Dt,get show(){return s(st)},set show(t){H(st,Q(t))}});var vt=m(ut,2);at(vt,{title:Mt,body:At,onClose:E,buttons:Lt,get show(){return s(Z)},set show(t){H(Z,Q(t))}});var jt=m(vt,2);de(jt,{get show(){return s(i)},set show(t){H(i,Q(t))}}),M(t=>G(R,1,`container mt-3 mb-3 ${t??""}`,"svelte-19s4utb"),[()=>u.isActive()?"navbar-aware":""]),fe(ct,()=>w.rune.atHome,t=>w.rune.atHome=t),x(n,rt),K()}Tt(["click"]);function ze(n,e){J(e,!0);var o=Xt(),i=nt(o);ae(i,()=>w.isLoaded(),null,(d,_)=>{xe(d,{})},(d,_)=>{oe(d,{})}),x(n,o),K()}export{ze as component};
