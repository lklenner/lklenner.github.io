import"../chunks/Bg9kRutz.js";import{t as f,p as me,c as s,s as l,j as H,r as a,k as v,a as ue,f as W}from"../chunks/B_fWjAJn.js";import{n as U,a as c,t as x,f as Me,c as ge}from"../chunks/CGZ7VXBK.js";import{t as Ie,P as C,S as J,p as Ae,q as G,Y as Oe,D as Ee,r as je,s as Be,y as De,h as Ve,d as de,c as Ne,i as Ye,g as Pe,R as He}from"../chunks/skvCeP1b.js";import{S as Je,a as R}from"../chunks/DsUiww_e.js";import{a as Ge,s as Ke}from"../chunks/-5UQ7fw5.js";import{s as K}from"../chunks/DuGrHTQZ.js";import{p as h,i as z}from"../chunks/BKxV5vi2.js";import{d as We}from"../chunks/dYPrhcUL.js";import{s as L}from"../chunks/99q-nmkb.js";import{p as ve}from"../chunks/BqFMnoIm.js";import{g as Re}from"../chunks/B5ji2ATe.js";import{T as F}from"../chunks/B46hv7NI.js";import{s as b}from"../chunks/Ct4An_w0.js";import{l as Ue,L as $e}from"../chunks/01nROYnL.js";function pe(n){return Ie(n).getFullYear()}var qe=U('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-file-earmark-arrow-up" viewBox="0 0 16 16"><path d="M8.5 11.5a.5.5 0 0 1-1 0V7.707L6.354 8.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 7.707z"></path><path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"></path></svg>');function Qe(n,i){let o=h(i,"size",3,16);h(i,"colorStyle",3,"");var r=qe();f(()=>{b(r,"width",o()),b(r,"height",o())}),c(n,r)}var Xe=U('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-file-earmark-arrow-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708z"></path><path d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383m.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"></path></svg>');function Ze(n,i){let o=h(i,"size",3,16);h(i,"colorStyle",3,"");var r=Xe();f(()=>{b(r,"width",o()),b(r,"height",o())}),c(n,r)}var ea=U('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-file-earmark-arrow-up" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"></path><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"></path></svg>');function aa(n,i){let o=h(i,"size",3,16);h(i,"colorStyle",3,"");var r=ea();f(()=>{b(r,"width",o()),b(r,"height",o())}),c(n,r)}async function ta(n,i){const o=localStorage.getItem(C.localStorageSaveKey);o&&i(o)}var sa=x('<li class="list-group-item list-group-item-warning"> </li>'),oa=x('<li class="list-group-item list-group-item-danger"> </li>'),ra=x('<ul class="list-group mb-3"></ul>'),ia=x('<p>Successfully found a timesheet.</p> <button type="button" class="btn btn-outline-secondary flex-fill" style="width: 7rem;">Import</button>',1),la=x(`<div class="container my-5"><div class="row p-4 pb-0 pt-lg-5 rounded-3 border shadow-lg"><div class="col pb-0 ps-lg-5 pe-lg-5 pt-lg-3"><h1 class="display-4 fw-bold lh-1 text-body-emphasis mb-5">Let's get you started</h1> <div class="accordion" id="accordionExample"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"><div class="d-flex align-items-center"><!> <div class="ms-4"><span class="lead h6">Import timesheet from save file</span></div></div></button></h2> <div id="collapseOne" data-bs-parent="#accordionExample"><div class="accordion-body"><p>Select the JSON file storing the timesheet. The file must be initially obtained by creating a new timesheet and saving it after any modification.</p> <div class="mt-3 mb-3" style="max-width: 30rem;"><input class="form-control" type="file" id="formFile" accept="application/json"></div> <!> <button type="button" class="btn btn-outline-secondary flex-fill" style="width: 7rem;">Import</button></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo"><div class="d-flex align-items-center"><!> <div class="ms-4"><span class="lead h6">Import timesheet from browser storage</span></div></div></button></h2> <div id="collapseTwo" data-bs-parent="#accordionExample"><div class="accordion-body"><!></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed lead display-6" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree"><div class="d-flex align-items-center"><!> <div class="ms-4"><span class="lead h6">Create new timesheet</span></div></div></button></h2> <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"><p>A new timesheet is created and loaded into the browser storage.</p> <button type="button" class="btn btn-outline-secondary flex-fill" style="width: 7rem;">New</button> <!></div></div></div></div> <div class="mt-4 mb-3 text-body-secondary d-flex justify-content-center"> </div></div></div></div>`);function na(n,i){me(i,!0);const o=localStorage.getItem(C.localStorageSaveKey)!==null;function r(){const e=new Date,t=G.new();t.settings=Ae.new(),t.year=Oe.new(pe(e));const d=Ee.getAllDaysOfYear(pe(e));for(const m of d)t.year.days.push(je.empty(m));t.tasks=[F.new("Pause",!1,!0,"#FFFFFF"),F.new("TaskA",!1,!1,"#FFFFFF"),F.new("TaskB",!1,!1,"#FFFFFF"),F.new("TaskC",!1,!1,"#FFFFFF")],$(t)}async function w(){const e=document.getElementById("formFile");if(e.files.length>0){const d=await e.files[0].text();k(d)}R.rune.modified=Je.Saved}function k(e){const t=JSON.parse(e);console.log(t),fe(t)}function fe(e){const t=G.import(e);$(t)}async function $(e){var t;e.tasks.length==0&&(e.tasks=[F.new("Pause",!1,!0,"#FFFFFF")]),Be.rune=e.settings,De.rune=e.year,Ve.rune=e.tasks,de.rune=e.tags,de.regenerateLookup(),C.saveToLocalStorage(),R.rune.loaded=!0,"logger"in(((t=e==null?void 0:e.settings)==null?void 0:t.capabilitiies)??[])&&Ue.setLogLevel($e.LOG),Re("/app")}let p=Ge(ve([]));async function he(){const e={warn:"warn",error:"error"};Ke(p,ve([]));const t=document.getElementById("formFile");if(t.files.length==0)return;const d=t.files[0];if(!d.name.toLowerCase().endsWith(".json")){v(p).push({level:e.error,msg:"Invalid file selection."});return}const m=await d.text();let _=null;try{_=JSON.parse(m)}catch(S){v(p).push({level:e.error,msg:"JSON parse error."}),console.log(S);return}let y=null;try{y=G.import(_)}catch(S){v(p).push({level:e.error,msg:"Incompatible data model used."}),console.log(S);return}y.settings.createdWith!=J.constants.version&&v(p).push({level:e.warn,msg:`Save version ${y.settings.createdWith} does not match system version ${J.constants.version}.`})}var T=la(),q=s(T),Q=s(q),M=l(s(Q),2),I=s(M),A=s(I),O=s(A);L(O,1,`accordion-button ${(o?"collapsed":"")??""}`);var X=s(O),be=s(X);Qe(be,{size:"20"}),H(2),a(X),a(O),a(A);var E=l(A,2);L(E,1,`accordion-collapse collapse ${(o?"":"show")??""}`);var Z=s(E),j=l(s(Z),2),we=s(j);we.__change=he,a(j);var ee=l(j,2);{var _e=e=>{var t=ra();Ne(t,21,()=>v(p),Ye,(d,m)=>{var _=ge(),y=W(_);{var S=g=>{var u=sa(),P=s(u,!0);a(u),f(()=>K(P,v(m).msg)),c(g,u)},Te=g=>{var u=oa(),P=s(u,!0);a(u),f(()=>K(P,v(m).msg)),c(g,u)};z(y,g=>{v(m).level=="warn"?g(S):g(Te,!1)})}c(d,_)}),a(t),c(e,t)};z(ee,e=>{v(p).length>0&&e(_e)})}var ye=l(ee,2);ye.__click=w,a(Z),a(E),a(I);var B=l(I,2),D=s(B),V=s(D);L(V,1,`accordion-button ${(o?"":"collapsed")??""} lead display-4`);var ae=s(V),Se=s(ae);Ze(Se,{size:"20"}),H(2),a(ae),a(V),a(D);var N=l(D,2);L(N,1,`accordion-collapse collapse ${(o?"show":"")??""}`);var te=s(N),Fe=s(te);{var xe=e=>{var t=ia(),d=l(W(t),2);d.__click=[ta,k],c(e,t)},ke=e=>{var t=Me("There is no timesheet stored in the browser. You must either load a timesheet from a file or create a new one.");c(e,t)};z(Fe,e=>{localStorage.getItem(C.localStorageSaveKey)?e(xe):e(ke,!1)})}a(te),a(N),a(B);var se=l(B,2),Y=s(se),oe=s(Y),re=s(oe),ze=s(re);aa(ze,{size:"20"}),H(2),a(re),a(oe),a(Y);var ie=l(Y,2),le=s(ie),ne=l(s(le),2);ne.__click=r;var Le=l(ne,2);z(Le,e=>{}),a(le),a(ie),a(se),a(M);var ce=l(M,2),Ce=s(ce);a(ce),a(Q),a(q),a(T),f(()=>K(Ce,`v${J.constants.version}`)),c(n,T),ue()}We(["change","click"]);function xa(n,i){me(i,!0);var o=ge(),r=W(o);Pe(r,()=>R.isGo(),null,(w,k)=>{na(w,{})},(w,k)=>{He(w,{})}),c(n,o),ue()}export{xa as component};
