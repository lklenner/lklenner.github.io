import"../chunks/Bg9kRutz.js";import{h as Rt,a8 as Yt,aB as jt,p as J,o,c as i,r as n,t as M,a as K,n as qt,f as nt,s as v,a1 as Ft,m as Vt,D as ft,l as zt}from"../chunks/wEK5ISei.js";import{t as A,a as x,c as Gt}from"../chunks/DxLYo54h.js";import{g as gt,k as Jt,y as Kt,h as Ut,s as ht,T as V,Q as bt,P as Wt,f as Xt}from"../chunks/BEXUmKBQ.js";import{R as Zt}from"../chunks/CwKPmUhM.js";import{a as D,o as kt,s as H}from"../chunks/Bz4N5Sz-.js";import{s as C}from"../chunks/D48oMBN9.js";import{p as P,i as $t}from"../chunks/D2qZXV1A.js";import{s as ot,r as te}from"../chunks/CFB-OgDw.js";import{s as G}from"../chunks/BocX-bhJ.js";import{l as ee,d as wt}from"../chunks/C7xThZtm.js";import{p as Q}from"../chunks/DZvTi5uQ.js";import{t as d,N as ae}from"../chunks/CTPyaS6G.js";import{N as oe,a as pt}from"../chunks/Dbm1Dayx.js";import{g as z}from"../chunks/BZ6SsMDz.js";import{D as _t,_ as ne}from"../chunks/BbL7Xf6s.js";import{T as se}from"../chunks/Lw-MJXe-.js";import{I as yt,a as w}from"../chunks/iye7cF-I.js";import{s as re}from"../chunks/HlA19gvM.js";import{T as ie}from"../chunks/CmRE5a5A.js";function ce(c,e,s=e){ee(c,"change",l=>{var m=l?c.defaultChecked:c.checked;s(m)}),(Rt&&c.defaultChecked!==c.checked||Yt(e)==null)&&s(c.checked),jt(()=>{var l=e();c.checked=!!l})}class I{static Button(e,s,l){return{text:e,cssClass:s,onClick:l}}}var le=A('<div class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><!></div></div></div>');function de(c,e){J(e,!0);let s=P(e,"id",7),l=P(e,"show",15);s(yt.makeDefault());let m=D(null),b="static";l(function(){var p;(p=o(m))==null||p.show()}),kt(()=>{H(m,Q(new bootstrap.Modal(`#${s()}`,{}))),document.getElementById(`${s()}`).addEventListener("hidden.bs.modal",E=>{var _;(_=e.onClose)==null||_.call(e,o(m))})});var u=le();ot(u,"data-bs-backdrop",b);var h=i(u),y=i(h),T=i(y);re(T,()=>e.content,()=>o(m)),n(y),n(h),n(u),M(()=>ot(u,"id",s())),x(c,u),K()}var me=(c,e,s,l)=>o(e).onClick(s(),l()),ue=A('<button type="button"> </button>'),ve=A('<div class="modal-header"><h5 class="modal-title"> </h5></div> <div class="modal-body"><p> </p></div> <div class="modal-footer"></div>',1);function at(c,e){J(e,!0);const s=(u,h=qt)=>{var y=ve(),T=nt(y),p=i(T),E=i(p,!0);n(p),n(T);var _=v(T,2),S=i(_),R=i(S,!0);n(S),n(_);var Y=v(_,2);gt(Y,21,l,Jt,(U,L)=>{var B=ue();B.__click=[me,L,h,m];var W=i(B,!0);n(B),M(()=>{G(B,1,`btn ${o(L).cssClass??""}`),C(W,o(L).text)}),x(U,B)}),n(Y),M(()=>{C(E,e.title),C(R,e.body)}),x(u,y)};let l=P(e,"buttons",19,()=>[]),m=P(e,"state",19,()=>({})),b=P(e,"show",15);yt.makeDefault(),de(c,{content:s,onClose:u=>e.onClose(u,m()),get show(){return b()},set show(u){b(u)}}),K()}wt(["click"]);class fe{static new(e,s,l){return{id:e,name:s,color:l}}}var he=(c,e,s)=>e(o(s)),be=A('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),pe=(c,e)=>{e("timesheet")},_e=A('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),ge=A(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!>  <!>  <!> <!> <!>`,1);function ke(c,e){J(e,!0);let s=D(""),l=D(void 0),m=Kt.getDay(new Date),b=ft(()=>{let t=[],a=0;for(const r of Ut.rune)r.hidden||(t.push(fe.new(a,r.name,r.color)),a++);return t});Ft(()=>{H(s,`${Math.floor(d.rune.duration/3600).toString().padStart(2,"0")}:${Math.floor(d.rune.duration/60%60).toString().padStart(2,"0")}:${(d.rune.duration%60).toString().padStart(2,"0")}`)});let u=null,h=null;const y=oe.Item("Home",()=>{R("home")});function T(t){var a;if(((a=d.rune.activeItem)==null?void 0:a.id)!==t.id){if(d.rune.activeItem)if(ht.rune.interaction.confirmAllTaskSwitches||d.rune.duration<5){u=t,o(X)();return}else S();p(t)}}async function p(t){d.activate(t),t.id===o(b).length-1&&(await zt(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function E(){}function _(){S(),d.deactivate()}function S(){const t=V.getTimestamp(d.rune.startTime),a=new Date,r=V.getTimestamp(a);let g=bt.Office;w.rune.atHome&&(g=bt.Home);const f=V.new(d.rune.activeItem.name,t,r,g,!1);try{V.validate(f)}catch(k){o(l)("Task entry was not created!",k.message,"text-bg-danger");return}m.timesheet.push(f),_t.enableTracked(m),_t.modified(m),console.log(f),Wt.modified(),o(l)("Created task entry",d.rune.activeItem.name,"text-bg-success")}function R(t){switch(h=t,h){case"back":pt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const Y="Confirm Item Switch",U=ft(()=>ht.rune.interaction.confirmAllTaskSwitches?"Are you sure you want to switch to another item?":"The current item has been active for less than a minute. Are you sure you want to switch to another item?"),L=I.Button("Yes, switch","btn-primary",function(a,r){S(),p(u),u=null,a.hide()}),B=I.Button("Cancel","btn-secondary",function(a,r){u=null,a.hide()}),W=[L,B];let X=D(void 0);const Tt="Confirm Leave",Bt="Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.",Ct=I.Button("Yes, leave","btn-primary",function(a,r){a.hide()}),xt=I.Button("Cancel","btn-secondary",function(a,r){h=null,a.hide()}),St=[Ct,xt];let st=D(void 0);function It(t,a){if(h)switch(d.isActive()&&_(),h){case"back":pt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const Dt="Set Quota Type",Ht="Are you working from your home or the office?",Mt=I.Button("Home","btn-primary",function(a,r){r.location="home",w.rune.atHome=!0,a.hide()}),At=I.Button("Office","btn-secondary",function(a,r){r.location="office",w.rune.atHome=!1,a.hide()}),Et=[Mt,At];let Z=D(void 0);kt(()=>{ie.enable(),w.rune.hasTracked||(o(Z)(),w.rune.hasTracked=!0)});var rt=ge(),it=nt(rt);ae(it,{name:"Track",navItems:[y]});var j=v(it,2),$=v(i(j),2),ct=i($);te(ct),Vt(2),n($);var tt=v($,2);gt(tt,21,()=>o(b),t=>t.name,(t,a)=>{var r=be();let g;r.__click=[he,T,a];var f=i(r),k=i(f),q=i(k),N=i(q,!0);n(q),n(k),n(f),n(r),M(et=>{var O,F;g=G(r,1,"col-12 mb-2 svelte-19s4utb",null,g,{active:((O=d.rune.activeItem)==null?void 0:O.name)===o(a).name}),G(f,1,`card p-3 ${(((F=d.rune.activeItem)==null?void 0:F.name)===o(a).name?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),ot(f,"style",`color: ${et??""}; background-color: ${o(a).color??""};`),C(N,o(a).name)},[()=>ne(o(a).color)]),x(t,r)}),n(tt);var Lt=v(tt,2);Lt.__click=[pe,R],n(j);var lt=v(j,2);{var Nt=t=>{var a=_e(),r=i(a),g=i(r),f=v(i(g),2),k=i(f),q=i(k,!0);n(k);var N=v(k,4),et=i(N,!0);n(N);var O=v(N,4),F=i(O,!0);n(O),n(f),n(g),n(r);var vt=v(r,2),Qt=i(vt);Qt.__click=_,n(vt),n(a),M(Pt=>{C(q,d.rune.activeItem.name),C(et,Pt),C(F,o(s))},[()=>d.rune.startTime.toLocaleTimeString("de-DE")]),x(t,a)};$t(lt,t=>{d.isActive()&&t(Nt)})}var dt=v(lt,2);at(dt,{title:Y,get body(){return o(U)},onClose:E,buttons:W,get show(){return o(X)},set show(t){H(X,Q(t))}});var mt=v(dt,2);at(mt,{title:Tt,body:Bt,onClose:It,buttons:St,get show(){return o(st)},set show(t){H(st,Q(t))}});var ut=v(mt,2);at(ut,{title:Dt,body:Ht,onClose:E,buttons:Et,get show(){return o(Z)},set show(t){H(Z,Q(t))}});var Ot=v(ut,2);se(Ot,{get show(){return o(l)},set show(t){H(l,Q(t))}}),M(t=>G(j,1,`container mt-3 mb-3 ${t??""}`,"svelte-19s4utb"),[()=>d.isActive()?"navbar-aware":""]),ce(ct,()=>w.rune.atHome,t=>w.rune.atHome=t),x(c,rt),K()}wt(["click"]);function je(c,e){J(e,!0);var s=Gt(),l=nt(s);Xt(l,()=>w.isLoaded(),null,(m,b)=>{ke(m,{})},(m,b)=>{Zt(m,{})}),x(c,s),K()}export{je as component};
