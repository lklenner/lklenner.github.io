import"../chunks/Bg9kRutz.js";import{h as jt,a8 as Pt,aB as Rt,p as J,k as o,c as i,r as n,t as M,a as K,n as Yt,f as nt,s as v,$ as qt,j as Ft,A as ft,i as Vt}from"../chunks/D6YVLWc7.js";import{t as A,a as x,c as zt}from"../chunks/CDD5XS2z.js";import{g as _t,i as Gt,y as Jt,h as Kt,s as ht,T as V,Q as bt,P as Ut,f as Wt}from"../chunks/NRRmGcJT.js";import{R as Xt}from"../chunks/BdK43quz.js";import{a as D,o as gt,s as H}from"../chunks/CcHHxoBb.js";import{s as C}from"../chunks/p4ygoAWT.js";import{p as j,i as Zt}from"../chunks/UPzZwpuN.js";import{s as ot,r as $t}from"../chunks/Br45A0WC.js";import{s as G}from"../chunks/CY6KYGQT.js";import{l as te,d as kt}from"../chunks/BI9NCyiX.js";import{p as Q}from"../chunks/DEahiPon.js";import{t as d,N as ee}from"../chunks/JStwdFNF.js";import{N as ae,a as pt}from"../chunks/Y1v8jMv6.js";import{g as z}from"../chunks/CUsFPPdr.js";import{_ as oe}from"../chunks/BdMqpO4Y.js";import{T as ne}from"../chunks/q98SwoL3.js";import{I as wt,a as w}from"../chunks/BPWqFRe1.js";import{s as se}from"../chunks/B8sxQAvJ.js";import{T as re}from"../chunks/CmRE5a5A.js";function ie(c,e,s=e){te(c,"change",l=>{var u=l?c.defaultChecked:c.checked;s(u)}),(jt&&c.defaultChecked!==c.checked||Pt(e)==null)&&s(c.checked),Rt(()=>{var l=e();c.checked=!!l})}class I{static Button(e,s,l){return{text:e,cssClass:s,onClick:l}}}var ce=A('<div class="modal fade" tabindex="-1" style="background: rgba(0, 0, 0, 0.5);"><div class="modal-dialog"><div class="modal-content"><!></div></div></div>');function le(c,e){J(e,!0);let s=j(e,"id",7),l=j(e,"show",15);s(wt.makeDefault());let u=D(null),b="static";l(function(){var p;(p=o(u))==null||p.show()}),gt(()=>{H(u,Q(new bootstrap.Modal(`#${s()}`,{}))),document.getElementById(`${s()}`).addEventListener("hidden.bs.modal",E=>{var _;(_=e.onClose)==null||_.call(e,o(u))})});var m=ce();ot(m,"data-bs-backdrop",b);var h=i(m),y=i(h),T=i(y);se(T,()=>e.content,()=>o(u)),n(y),n(h),n(m),M(()=>ot(m,"id",s())),x(c,m),K()}var de=(c,e,s,l)=>o(e).onClick(s(),l()),me=A('<button type="button"> </button>'),ue=A('<div class="modal-header"><h5 class="modal-title"> </h5></div> <div class="modal-body"><p> </p></div> <div class="modal-footer"></div>',1);function at(c,e){J(e,!0);const s=(m,h=Yt)=>{var y=ue(),T=nt(y),p=i(T),E=i(p,!0);n(p),n(T);var _=v(T,2),S=i(_),P=i(S,!0);n(S),n(_);var R=v(_,2);_t(R,21,l,Gt,(U,N)=>{var B=me();B.__click=[de,N,h,u];var W=i(B,!0);n(B),M(()=>{G(B,1,`btn ${o(N).cssClass??""}`),C(W,o(N).text)}),x(U,B)}),n(R),M(()=>{C(E,e.title),C(P,e.body)}),x(m,y)};let l=j(e,"buttons",19,()=>[]),u=j(e,"state",19,()=>({})),b=j(e,"show",15);wt.makeDefault(),le(c,{content:s,onClose:m=>e.onClose(m,u()),get show(){return b()},set show(m){b(m)}}),K()}kt(["click"]);class ve{static new(e,s,l){return{id:e,name:s,color:l}}}var fe=(c,e,s)=>e(o(s)),he=A('<div style="cursor: pointer;"><div><span><strong> </strong></span></div></div>'),be=(c,e)=>{e("timesheet")},pe=A('<div class="position-fixed bottom-0 start-0 w-100 bg-light border-top py-2 px-3 d-flex align-items-center justify-content-between"><div class="container gap-1"><div class="row"><div class="col col-md-auto"><strong class="me-2 text-nowrap">Active:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Started:</strong> <div class="w-100"></div> <strong class="me-2 text-nowrap">Duration:</strong></div> <div class="col col-md-auto"><span> </span> <div class="w-100"></div> <span> </span> <div class="w-100"></div> <span> </span></div></div></div> <div><button class="btn btn-outline-danger">Stop Task</button></div></div>'),_e=A(`<!> <div id="taskContainer"><h1 class="mb-3">Track today's tasks</h1>  <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="homeOfficeToggle"> <label class="form-check-label" for="homeOfficeToggle">Homeoffice</label></div> <div class="row"></div> <button id="timesheetBtn" type="button" class="btn btn-outline-secondary mt-3">Switch to Timesheet</button></div> <!>  <!>  <!> <!> <!>`,1);function ge(c,e){J(e,!0);let s=D(""),l=D(void 0),u=Jt.getDay(new Date),b=ft(()=>{let t=[],a=0;for(const r of Kt.rune)r.hidden||(t.push(ve.new(a,r.name,r.color)),a++);return t});qt(()=>{H(s,`${Math.floor(d.rune.duration/3600).toString().padStart(2,"0")}:${Math.floor(d.rune.duration/60%60).toString().padStart(2,"0")}:${(d.rune.duration%60).toString().padStart(2,"0")}`)});let m=null,h=null;const y=ae.Item("Home",()=>{P("home")});function T(t){var a;if(((a=d.rune.activeItem)==null?void 0:a.id)!==t.id){if(d.rune.activeItem)if(ht.rune.interaction.confirmAllTaskSwitches||d.rune.duration<5){m=t,o(X)();return}else S();p(t)}}async function p(t){d.activate(t),t.id===o(b).length-1&&(await Vt(),document.getElementById("timesheetBtn").scrollIntoView({behavior:"smooth"}))}function E(){}function _(){S(),d.deactivate()}function S(){const t=V.getTimestamp(d.rune.startTime),a=new Date,r=V.getTimestamp(a);let g=bt.Office;w.rune.atHome&&(g=bt.Home);const f=V.new(d.rune.activeItem.name,t,r,g,!1);try{V.validate(f)}catch(k){o(l)("Task entry was not created!",k.message,"text-bg-danger");return}u.timesheet.push(f),console.log(f),Ut.modified(),o(l)("Created task entry",d.rune.activeItem.name,"text-bg-success")}function P(t){switch(h=t,h){case"back":pt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const R="Confirm Item Switch",U=ft(()=>ht.rune.interaction.confirmAllTaskSwitches?"Are you sure you want to switch to another item?":"The current item has been active for less than a minute. Are you sure you want to switch to another item?"),N=I.Button("Yes, switch","btn-primary",function(a,r){S(),p(m),m=null,a.hide()}),B=I.Button("Cancel","btn-secondary",function(a,r){m=null,a.hide()}),W=[N,B];let X=D(void 0);const yt="Confirm Item Switch",Tt="Are you sure you want to leave the site while the tracker is active? Leaving causes the tracking to stop.",Bt=I.Button("Yes, leave","btn-primary",function(a,r){a.hide()}),Ct=I.Button("Cancel","btn-secondary",function(a,r){h=null,a.hide()}),xt=[Bt,Ct];let st=D(void 0);function St(t,a){if(h)switch(d.isActive()&&_(),h){case"back":pt.goBack();break;case"timesheet":z(`/app/year/${new Date().getMonth()}/${new Date().getDate()}/timesheet`);break;case"home":default:z("/app");break}}const It="Set Quota Type",Dt="Are you working from your home or the office?",Ht=I.Button("Home","btn-primary",function(a,r){r.location="home",w.rune.atHome=!0,a.hide()}),Mt=I.Button("Office","btn-secondary",function(a,r){r.location="office",w.rune.atHome=!1,a.hide()}),At=[Ht,Mt];let Z=D(void 0);gt(()=>{re.enable(),w.rune.hasTracked||(o(Z)(),w.rune.hasTracked=!0)});var rt=_e(),it=nt(rt);ee(it,{name:"Track",navItems:[y]});var Y=v(it,2),$=v(i(Y),2),ct=i($);$t(ct),Ft(2),n($);var tt=v($,2);_t(tt,21,()=>o(b),t=>t.name,(t,a)=>{var r=he();let g;r.__click=[fe,T,a];var f=i(r),k=i(f),q=i(k),O=i(q,!0);n(q),n(k),n(f),n(r),M(et=>{var L,F;g=G(r,1,"col-12 mb-2 svelte-19s4utb",null,g,{active:((L=d.rune.activeItem)==null?void 0:L.name)===o(a).name}),G(f,1,`card p-3 ${(((F=d.rune.activeItem)==null?void 0:F.name)===o(a).name?"border-primary shadow active-item border-4":"border-2 ")??""}`,"svelte-19s4utb"),ot(f,"style",`color: ${et??""}; background-color: ${o(a).color??""};`),C(O,o(a).name)},[()=>oe(o(a).color)]),x(t,r)}),n(tt);var Et=v(tt,2);Et.__click=[be,P],n(Y);var lt=v(Y,2);{var Nt=t=>{var a=pe(),r=i(a),g=i(r),f=v(i(g),2),k=i(f),q=i(k,!0);n(k);var O=v(k,4),et=i(O,!0);n(O);var L=v(O,4),F=i(L,!0);n(L),n(f),n(g),n(r);var vt=v(r,2),Lt=i(vt);Lt.__click=_,n(vt),n(a),M(Qt=>{C(q,d.rune.activeItem.name),C(et,Qt),C(F,o(s))},[()=>d.rune.startTime.toLocaleTimeString("de-DE")]),x(t,a)};Zt(lt,t=>{d.isActive()&&t(Nt)})}var dt=v(lt,2);at(dt,{title:R,get body(){return o(U)},onClose:E,buttons:W,get show(){return o(X)},set show(t){H(X,Q(t))}});var mt=v(dt,2);at(mt,{title:yt,body:Tt,onClose:St,buttons:xt,get show(){return o(st)},set show(t){H(st,Q(t))}});var ut=v(mt,2);at(ut,{title:It,body:Dt,onClose:E,buttons:At,get show(){return o(Z)},set show(t){H(Z,Q(t))}});var Ot=v(ut,2);ne(Ot,{get show(){return o(l)},set show(t){H(l,Q(t))}}),M(t=>G(Y,1,`container mt-3 mb-3 ${t??""}`,"svelte-19s4utb"),[()=>d.isActive()?"navbar-aware":""]),ie(ct,()=>w.rune.atHome,t=>w.rune.atHome=t),x(c,rt),K()}kt(["click"]);function Re(c,e){J(e,!0);var s=zt(),l=nt(s);Wt(l,()=>w.isLoaded(),null,(u,b)=>{ge(u,{})},(u,b)=>{Xt(u,{})}),x(c,s),K()}export{Re as component};
